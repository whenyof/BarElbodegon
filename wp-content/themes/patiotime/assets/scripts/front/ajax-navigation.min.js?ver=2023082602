!function(p){function l(a,t){a&&a.more?patiotimeAjaxNavigation.data.query.paged++:t.hasClass("infinite")?(t.find(".load-more-btn.ajax").remove(),t.removeClass("infinite").append(p("<span>",{class:"no-more-posts-message",text:patiotimeAjaxNavigation.noMoreText}))):(t.find(".load-more-btn.ajax.manual").remove(),t.append(p("<span>",{class:"no-more-posts-message",text:patiotimeAjaxNavigation.noMoreText}))),t.data("loading",!1).removeClass("loading")}var a;patiotimeAjaxNavigation&&((a=p(document)).on("patiotimeAjaxNavigationProcessData",function(a,t){var i,o,e,n,s,r,d=t.target.closest(".navigation.pagination").siblings(".posts-wrapper").parent();d.length&&d.hasClass("posts")&&p(t.data.items).length&&(e=(o=(i=p("<div>").append(t.data.items)).find(".image-gallery")).length,n=p.fn.loftoceanImageLoading,i.children().addClass("new-post-item post").css("opacity",0),d.hasClass("layout-masonry")?(s=d.data("post-list")?d.data("post-list"):[],r=d.find(".masonry-column"),i.children().each(function(){s.unshift(p(this))}),d.data("post-list",s),d.data("mobile-mode")?r.first().append(i.children()):(r.first().append(i.children()),d.patiotimeMasonry({post:".post.new-post-item",append:!0}),e&&o.patiotimePostsGallery()),p(document).trigger("loftcean/moreContent/loaded"),d.find(".new-post-item").removeClass("new-post-item").fadeTo(300,1)):(d.find(".posts-wrapper").append(i.children()),p(document).trigger("loftcean/moreContent/loaded",{videos:!(!t.data.videos||!Array.isArray(t.data.videos))&&t.data.videos}),d.find(".new-post-item").removeClass("new-post-item").fadeTo(300,1),e&&o.patiotimePostsGallery(),p(document).trigger("changed.patiotime.mainContent")),l(t.data,t.target),n&&d.loftoceanImageLoading())}),p("body").on("patiotimeAjaxNavigationStart",".pagination-container.load-more",function(a){a.preventDefault();var t=p(this),i=t.parents(".posts");if(t.data("loading"))return!1;t.data("loading",!0).addClass("loading");a=!1;i.length&&i.first().attr("data-settings")?(i=i.first(),(a=JSON.parse(i.attr("data-settings"))).query.paged+=1,i.attr("data-settings",JSON.stringify(a)),a.action=patiotimeAjaxNavigation.data.action):a=patiotimeAjaxNavigation.data,p.post(patiotimeAjaxNavigation.url,a).done(function(a){a.success?p(document).trigger("patiotimeAjaxNavigationProcessData",{data:a.data,target:t}):t.data("loading",!1).removeClass("loading")}).fail(function(){t.data("loading",!1).removeClass("loading")})}).on("click",".load-more-btn.ajax.manual",function(a){a.preventDefault(),p(this).closest(".pagination-container.load-more").trigger("patiotimeAjaxNavigationStart")}),a.data("previousTop",patiotimeParseInt(p(window).scrollTop())),a.on("scrolling.patiotime.window",function(a){var t,i=p(this),o=patiotimeParseInt(p(window).scrollTop()),e=p(".pagination-container.load-more.infinite");e.length&&i.data("previousTop")&&i.data("previousTop")<o&&(t=patiotimeParseInt(o)+patiotimeParseInt(p(window).height()),e.each(function(){var a=p(this).closest(".navigation.pagination").offset().top;if(o<a&&a<t)return p(this).trigger("patiotimeAjaxNavigationStart"),!1})),i.data("previousTop",o)}))}(jQuery);
